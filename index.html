<!DOCTYPE html>
<html>
<head>
    <title>Small asynchronous website/webapp examples for snowplow.js</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

    <!-- Snowplow starts plowing -->
    <script type="text/javascript">

        ;(function(p,l,o,w,i,n,g){if(!p[i]){p.GlobalSnowplowNamespace=p.GlobalSnowplowNamespace||[];
        p.GlobalSnowplowNamespace.push(i);p[i]=function(){(p[i].q=p[i].q||[]).push(arguments)
        };p[i].q=p[i].q||[];n=l.createElement(o);g=l.getElementsByTagName(o)[0];n.async=1;
        n.src=w;g.parentNode.insertBefore(n,g)}}(window,document,"script","https://d1fc8wv8zag5ca.cloudfront.net/2.7.2/sp.js","snowplow"));

        window.snowplow('newTracker', 'collector', 'localhost:8080', { // Initialise a tracker
          appId: 'Showcase',
        //   platform: 'web',
        //   contexts: {
        //     webPage: true,
        //     gaCookies: true,
        //     performanceTiming: true
        //   }
        });

    </script>
    <!-- Snowplow stops plowing -->

    <!-- Example events -->
    <script type="text/javascript">

        function playMix() {
            window.snowplow('trackStructEvent', 'Mixes', 'Play', 'MRC/fabric-0503-mix', '', '0.0');
        }

        function addProduct() {
            window.snowplow('trackStructEvent', 'Checkout', 'Add', 'ASO01043', 'blue:xxl', '2.0', [{
              schema: 'iglu:com.acme_company/user/jsonschema/1-0-0',
              data: { fbUid: '123456 x' }
            }] );
        }

        function viewProduct() {
            window.snowplow('trackUnstructEvent', {
                schema: 'iglu:com.acme_company/viewed_product/jsonschema/5-0-0',
                data: {
                    productId: 'ASO01043',
                    category: 'Dresses',
                    brand: 'ACME',
                    returning: true,
                    price: 49.95,
                    sizes: ['xs', 's', 'l', 'xl', 'xxl'],
                    availableSince: new Date(2013,3,7)
              }
            });
        }

        function addEcommerceTransaction() {
          var orderId = 'order-123';

          // addTrans sets up the transaction, should be called first.
          window.snowplow('addTrans',
              orderId,                // order ID - required
              '',                     // affiliation or store name
              '8000',                 // total - required
              '',                     // tax
              '',                     // shipping
              '',                     // city
              '',                     // state or province
              '',                     // country
              'JPY'                   // currency
              );

          // addItem might be called for each item in the shopping cart,
          // or not at all.
          window.snowplow('addItem',
              orderId,                // order ID - required
              '1001',                 // SKU - required
              'Blue t-shirt',         // product name
              '',                     // category
              '2000',                 // unit price - required
              '2',                    // quantity - required
              'JPY',                  // currency
              [{                      // context
                schema: "iglu:com.example_company/products/jsonschema/1-0-0",
                data: {
                  "launchDate": new Date(2013,3,7)
                }
              }]);

          window.snowplow('addItem',
              orderId,                // order ID - required
              '1002',                 // SKU - required
              'Red shoes',            // product name
              '',                     // category
              '4000',                 // unit price - required
              '1',                    // quantity - required
              'JPY'                   // currency
              );

          // trackTrans sends the transaction to Snowplow tracking servers.
          // Must be called last to commit the transaction.
          window.snowplow('trackTrans');

        }
    </script>
</head>

<body>
    <h1>Event Tracker Example</h1>

    <p>Press the buttons below to trigger individual tracking events:<br><br>
        <button type="button" onclick="playMix()">Play a mix</button><br>
        <button type="button" onclick="addProduct()">Add a product</button><br>
        <button type="button" onclick="viewProduct()">View a product</button><br>
        <button type="button" onclick="addEcommerceTransaction()">Add an ecommerce transaction</button>
    </p>
</body>
</html>